var KS_LP_global_font_size,KS_LP_content,KS_LP_time_recorded,KS_LP_time_now,KS_LP_registration_code="ZnJlZUBmcmVlQHNhcGFyYXRlQDE=",KS_LP_settings_default={type:"html_element",img_size:"148px",size:"normal",position:"top",components:["image","title","site_name","description","close-button"],loader:"infinity",theme:"light"},KS_LP_global_plugin_path="plugins/koreksoft-link-previewer/",KS_LP_last_requested_url=null,KS_LP_last_requested_data=null,KS_LP_last_textarea_value=null,Style_load_status=!1,KS_LP_delay_before_request=2e3,KS_LP_all_data={to_declare_that_this_is_an_object:"kosong"};function KS_LP_check_wadah(e,_){return 0!=$("#"+e).length}function KS_LP_getElementLength(e,_){return KS_LP_getElement(e,_).length}function KS_LP_getElement(e,_){return $('[koreksoft_lp="'+e+'"]')}function KS_LP_getTarget(e,_){return $("#"+e)}function KS_LP_create_wadah(e,_){var t="display: none;";"normal"==_.size&&void 0!==_.img_size&&(t+="max-height:"+_.img_size+";"),void 0===_.extra_css?_.extra_css="":t+=_.extra_css;let i=KS_LP_getWrapper(e);KS_LP_content='<div class="wadah_previewer-'+_.size+'" id="'+e+'" style="'+t+'"></div>',"top"==_.position?$(i).prepend(KS_LP_content):"bottom"==_.position&&$(i).append(KS_LP_content)}function KS_LP_create_wrapper(e,_){let t=KS_LP_getElement(e,_),i=!0;return void 0===_.theme&&(_.theme="light"),void 0===_.font_size&&(_.font_size="100%"),KS_LP_content='<div class="'+_.theme+'" id="KS_wrapper'+e+'" style="display:block; font-size:'+_.font_size+'; "></div>',"top"==_.position&&0==KS_LP_getWrapper(e)?$(KS_LP_content).insertBefore(t):"bottom"==_.position&&0==KS_LP_getWrapper(e)?$(KS_LP_content).insertAfter(t):i=!1,i}function KS_LP_getWrapper(e){return 0!=$("#KS_wrapper"+e).length&&"#KS_wrapper"+e}function KS_LP_create_loader(e,_){let t=KS_LP_getWrapper(e);0!=t?(KS_LP_content='<div class="'+_.size+'-loader" id="'+e+'loader" style="display: none;"><img src="'+_.plugin_path+"img/loader-"+_.loader+'.gif"></div>',"top"==_.position?$(t).append(KS_LP_content):"bottom"==_.position&&$(t).prepend(KS_LP_content)):console.log("Failed to create wrapper element!")}function KS_LP_close_previewer(e,_){var t=KS_LP_getTarget(e,{size:_});t.hide(400),setTimeout(function(){t.remove()},500)}function KS_LP_showLoader(e,_){setTimeout(function(){$("#"+e+"loader").show()},300)}function KS_LP_hideLoader(e,_){setTimeout(function(){$("#"+e+"loader").hide()},800)}function KS_LP_is_loader_exists(e,_){return 0!=$("#"+e+"loader").length}function KS_LP_encode(e){var _=window.btoa(e);return _=_.replace(new RegExp(/\//g),"garis_miring")}function KS_LP_decode(e,_,t){try{return window.atob(t)}catch(t){KS_LP_printConsole(_,"LP: Error on decoding data!"),KS_LP_terminate_all_process(e,_),KS_LP_close_previewer(e,_.size),KS_LP_hideLoader(e,_)}}function KS_LP_looping_data(e,_,t){var i=KS_LP_getTarget(_,t),n=(t.size,""),r="";"normal"==t.size?(n='style="width:'+t.img_size+';"',r='style="width:'+t.img_size+"; height:"+t.img_size+"; background-image: url('"+t.plugin_path+"img/loader-"+t.loader+".gif'); background-repeat: no-repeat; background-position: center; background-size:20px;\""):"large"==t.size&&(n='style="height:'+t.img_size+';"',r="style=\"background-image: url('"+t.plugin_path+"img/loader-"+t.loader+".gif'); background-position:center; background-repeat: no-repeat; background-size:20px;\"");for(var o=0;o<t.components.length;o++)if("image"==t.components[o])0==$("#"+_+"previewer_image").length?e.og_image&&(KS_LP_content='<div class="previewer_image" id="'+_+'previewer_image" '+r+'><img src="'+e.og_image+'" '+n+"></div>",i.append(KS_LP_content)):$("#"+_+"previewer_image img").attr("src",e.og_image);else if("title"==t.components[o])0==$("#"+_+"previewer_title").length?e.og_title?(KS_LP_content='<p class="previewer_title" id="'+_+'previewer_title">'+e.og_title+"</p>",i.append(KS_LP_content)):e.page_title&&(KS_LP_content='<p class="previewer_title" id="'+_+'previewer_title">'+e.page_title+"</p>",i.append(KS_LP_content)):e.og_title?$("#"+_+"previewer_title").html(e.og_title):e.page_title&&$("#"+_+"previewer_title").html(e.page_title);else if("site_name"==t.components[o])0==$("#"+_+"previewer_site_name").length?e.og_site_name&&(KS_LP_content='<p class="previewer_site_name" id="'+_+'previewer_site_name">'+e.og_site_name+"</p>",i.append(KS_LP_content)):$("#"+_+"previewer_site_name").html(e.og_site_name);else if("source_url"==t.components[o])0==$("#"+_+"previewer_source_url").length?e.source_url&&(KS_LP_content='<p class="previewer_source_url" id="'+_+'previewer_source_url">'+e.source_url+"</p>",i.append(KS_LP_content)):$("#"+_+"source_url").html(e.source_url);else if("description"==t.components[o]){if(e.og_image)var s='<span class="previewer_description_overlay" id="'+_+'previewer_description_overlay" style="left:'+t.img_size+';"></span>';else s='<span class="previewer_description_overlay" id="'+_+'previewer_description_overlay"></span>';0==$("#"+_+"previewer_description").length?e.og_description?(KS_LP_content='<p class="previewer_description" id="'+_+'previewer_description">'+e.og_description+s+"</p>",i.append(KS_LP_content)):e.description&&(KS_LP_content='<p class="previewer_description" id="'+_+'previewer_description">'+e.description+s+"</p>",i.append(KS_LP_content)):e.og_description?$("#"+_+"previewer_description").html(e.og_description+s):e.description&&$("#"+_+"previewer_description").html(e.description+s)}else"site_name"==t.components[o]?0==$("#"+_+"previewer_site_name").length?e.og_site_name&&(KS_LP_content='<p class="previewer_site_name" id="'+_+'previewer_site_name">'+e.og_site_name+"</p>",i.append(KS_LP_content)):$("#"+_+"previewer_site_name").html(e.og_site_name):"close-button"==t.components[o]&&0==$("#"+_+"previewer_close").length&&(KS_LP_content='<a class="previewer_close" id="'+_+'previewer_close" href="javascript:void(0)" onclick="KS_LP_close_previewer(\''+_+"', '"+t.size+"')\">&times;</a>",i.append(KS_LP_content))}function KS_LP_susun_komponen_previewer(e,_,t){KS_LP_getElement(_,t);t.size;var i=KS_LP_getTarget(_,t);0==KS_LP_check_wadah(_,t)?(KS_LP_create_wadah(_,t),KS_LP_looping_data(e,_,t)):KS_LP_looping_data(e,_,t),"none"==(i=KS_LP_getTarget(_,t)).css("display")&&i.show(400)}function seleksi_string_url(e){let _;for(var t=0;t<e.length;t++)e[t].length>8&&0==e[t].toLowerCase().indexOf("http")&&(_=KS_LP_last_requested_url==e[t]?"masih_sama":e[t]);return void 0===_&&(_=!1),_}function KS_LP_decodeHtml(e){var _=document.createElement("textarea");return _.innerHTML=e,_.value}function KS_LP_get_the_url(e,_){let t=KS_LP_getElement(e,_);var i=!1,n=("html_element"==_.type?t.html():"hyperlink"==_.type?t.attr("href"):"use_editor_plugin"==_.type?KS_LP_decodeHtml(t.val()):t.val()).replace(/(\r\n|\n|\r)/gm," ").replace(/<\/?[^>]+(>|$)/g," ").split(new RegExp(/\s/));if("live"==_.type)for(var r=0;r<n.length;r++)n[r].length>8&&0==n[r].indexOf("http")&&(i=KS_LP_last_requested_url==n[r]?"masih_sama":n[r]);else i="html_element"==_.type?seleksi_string_url(n):(_.type,seleksi_string_url(n));return i}function KS_LP_printConsole(e,_){1==e.console&&console.log(_)}function KS_LP_make_request(e,_,t){KS_LP_getElement(e,_);if(KS_LP_getTarget(e,_)){KS_LP_showLoader(e,_),KS_LP_printConsole(_,"Requesting ...");var i=KS_LP_decode(e,_,KS_LP_registration_code),n=KS_LP_encode(t+"@pembatas@"+i);let r=_.api_receiver_path+n;KS_LP_printConsole(_,"URL = "+t),KS_LP_printConsole(_,"Request code: "+n),$.ajax({url:r,type:"GET",success:function(i){i=KS_LP_decode(e,_,i),KS_LP_printConsole(_,"Data acquired"),i.length<5&&(KS_LP_printConsole(_,"Due to empty data ..."),KS_LP_terminate_all_process(e,_),KS_LP_close_previewer(e,_.size));var n=JSON.parse(i);KS_LP_printConsole(_,"Parsing data ..."),"fail"==n.status?(KS_LP_close_previewer(e,_.size),KS_LP_printConsole(_,`Parsing data [${n.status}]!`),KS_LP_printConsole(_,i),KS_LP_hideLoader(e,_)):"success"==n.status&&(KS_LP_printConsole(_,`Parsing data [${n.status}]!`),KS_LP_printConsole(_,n),KS_LP_last_requested_url!=t?(KS_LP_close_previewer(e,_.size),setTimeout(function(){KS_LP_susun_komponen_previewer(n,e,_)},600)):KS_LP_susun_komponen_previewer(n,e,_),KS_LP_last_requested_data=n,KS_LP_last_requested_url=t,KS_LP_printConsole(_,"--koreksoft request ended"),void 0!==_.get_data&&(KS_LP_all_data[e]=n,KS_LP_get_data(e,_)),KS_LP_hideLoader(e,_))},fail:function(e,_,t){alert("Link Preview Error:"+t)}})}}function KS_LP_get_data(e,_){for(var t=0;t<_.get_data.index.length;t++){let i=KS_LP_all_data[e][_.get_data.index[t]];void 0!==i&&$("#"+_.get_data.target[t]).val(i)}}function KS_LP_load_css(e,_){0==Style_load_status&&(Style_load_status=!0,$.get(_.plugin_path+"css/style.css",function(e,_){var t=new RegExp("{-&-}font-size{-&-}","g");e="<style>"+(e=e.replace(t,KS_LP_global_font_size))+"</style>",$("head").append(e)}))}function KS_LP_init(e,_){if("live"==_.type||"use_editor_plugin"==_.type||"use_editor_plugin"==_.type){KS_LP_getElement(e,_).attr("oninput","triggered_oninput()")}KS_LP_load_css(e,_),1==KS_LP_create_wrapper(e,_)&&0==KS_LP_is_loader_exists(e,_)&&"no_loader"!=_.loader&&(KS_LP_create_loader(e,_),KS_LP_showLoader(e,_)),_.api_receiver_path=_.plugin_path+"php/api_receiver.php?koreksoft_lp=",0==KS_LP_check_wadah(e,_)&&KS_LP_create_wadah(e,_),"live"==_.type||"use_editor_plugin"==_.type?typing_status_detector_for_live_preview(e,_):KS_LP_main_function(e,_)}function typing_status_detector_for_live_preview(e,_){KS_LP_time_recorded=(new Date).getTime(),setTimeout(function(){(KS_LP_time_now=(new Date).getTime())-KS_LP_time_recorded>=KS_LP_delay_before_request?(KS_LP_printConsole(_,"Typing is done"),KS_LP_main_function(e,_)):KS_LP_printConsole(_,"Still typing ...")},KS_LP_delay_before_request)}function KS_LP_main_function(e,_){KS_LP_printConsole(_,"--koreksoft lp begins");let t=KS_LP_getElement(e,_),i=KS_LP_get_the_url(e,_);0==i?(KS_LP_close_previewer(e,_.size),KS_LP_printConsole(_,"--koreksoft request just ignored"),KS_LP_hideLoader(e,_)):"masih_sama"==i?(void 0!==_.get_data&&(KS_LP_all_data[e]=KS_LP_last_requested_data,KS_LP_get_data(e,_)),KS_LP_susun_komponen_previewer(KS_LP_last_requested_data,e,_),KS_LP_printConsole(_,"-- ignored (same URL)"),KS_LP_hideLoader(e,_)):(KS_LP_printConsole(_,"Preparing to request ..."),0!=KS_LP_getWrapper(e)?KS_LP_make_request(e,_,i):KS_LP_printConsole(_,"Wrapper is missing!")),KS_LP_last_textarea_value=t.val()}function KS_LP_terminate_all_process(e,_){KS_LP_printConsole(_,"Loader closed!"),KS_LP_hideLoader(e,_)}function KS_LP_ubah_marker_of_multiple_elements(e,_,t){var i=KS_LP_getElement(e,t),n=null,r=0;i.each(function(){n=e+"-"+r,$(this).attr("koreksoft_lp",n),KS_LP_init(n,t),r++})}function KS_LP_run_previewer(e,_){void 0===_?_=KS_LP_settings_default:(void 0===_.type&&(_.type=KS_LP_settings_default.type),void 0===_.img_size&&(_.img_size=KS_LP_settings_default.img_size),void 0===_.size&&(_.size=KS_LP_settings_default.size),void 0===_.position&&(_.position=KS_LP_settings_default.position),void 0===_.components&&(_.components=KS_LP_settings_default.components),void 0===_.loader&&(_.loader=KS_LP_settings_default.loader),void 0===_.theme&&(_.theme=KS_LP_settings_default.theme)),void 0===_.plugin_path&&(_.plugin_path=KS_LP_global_plugin_path),void 0===KS_LP_global_font_size&&(KS_LP_global_font_size="100%");var t=KS_LP_getElementLength(e,_);1==t?KS_LP_init(e,_):t>1&&KS_LP_ubah_marker_of_multiple_elements(e,t,_)}function KS_LP_switch_theme_DEMO(e){var _=$('div[id*="KS_wrapper'+e+'"]');_.hasClass("dark")?(_.removeClass("dark"),_.addClass("light")):_.hasClass("light")&&(_.removeClass("light"),_.addClass("dark"))}function KS_LP_set_global_font_size(e){KS_LP_global_font_size=e}function KS_LP_set_reg_code(e){KS_LP_registration_code=e}function KS_LP_set_global_plugin_path(e){KS_LP_global_plugin_path=e}function KS_LP_set_font_size_DEMO(e,_){$('[id*="KS_wrapper'+e+'"]').css("font-size",_)}function KS_LP_set_img_size_DEMO(e,_){_=_;var t=$('[id*="'+e+'"][id$="previewer_image"]'),i=t.parent();if(i.hasClass("wadah_previewer-large")){var n=t.children("img");t.css("height",_),n.css("height",_)}else if(i.hasClass("wadah_previewer-normal")){n=t.children("img");t.css("width",_),t.css("height",_),n.css("width",_),$('[id*="'+e+'"][id$="previewer_description_overlay"]').css("left",_),t.parent().css("max-height",_)}}